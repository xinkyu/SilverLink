# 聊天与 AI 陪伴 (Chat & AI Companion)

SilverLink 的核心功能之一是基于大语言模型（LLM）的智能陪伴，旨在通过自然的语音交互为长辈提供情感支持、生活助手和记忆训练功能。

## 功能特性

### 1. 智能语音对话
- **多轮对话能力**：基于通义千问 (Qwen) 大模型，支持上下文理解，能够进行流畅的自然语言对话。
- **方言支持**：
    - 支持多种方言输出（如四川话、广东话等），让交流更亲切。
    - 通过家人端配对时 `UserConfig` 配置方言偏好。
- **情感化语音 (TTS)**：
    - 集成阿里云 CosyVoice 语音合成服务。
    - 支持多种情感表达（快乐、严肃、悲伤等），根据对话内容自动调整语音情感。

### 2. 声音复刻 (Voice Cloning)
- **亲情语音**：允许家人录制一段音频（10-20秒），通过 AI 复刻家人的声音。
- **应用场景**：AI 助手将使用复刻的家人声音与长辈交流，增加信任感和亲切感。
- **技术实现**：
    1. 录制/上传音频到云存储 (Tencent COS)。
    2. 调用阿里云 CosyVoice API 进行声音模型训练。
    3. 生成唯一的 `voice_id` 用于后续的 TTS 合成。

### 3. 主动关怀 (Proactive Interaction)
- **智能监测**：
    - 利用设备传感器（步数计数器、加速度计）监测长辈的活动状态。
    - 识别"久坐"或"长时间无响应"状态。
- **主动问候**：
    - 当检测到长时间不活跃时，AI 会主动唤醒屏幕并语音问候。
    - 问候语由 AI 根据长辈当前状态、最近情绪记录自动生成，拒绝机械式提醒。
- **记忆小游戏**：
    - 在适当时机（如主动问候时），AI 会邀请长辈进行"记忆小游戏"（基于上传的老照片提问），帮助活跃大脑。

### 4. 紧急联系
- **连续无响应检测**：如果主动关怀唤醒后，长辈在多次尝试中仍无反应（未移动设备或解锁），系统将判定为异常。
- **自动警报**：触发紧急警报机制，通知家人端应用。

## 技术架构

- **ProactiveInteractionService**: 常驻后台的前台服务，负责传感器数据采集和逻辑判断。
- **TextToSpeechService**: 封装 TTS 逻辑，处理音频流播放。
- **VoiceCloningService**: 管理声音复刻流程，包括上传、训练和状态查询。
- **ChatViewModel**: 管理对话状态和 UI 交互。
