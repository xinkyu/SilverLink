# 设备配对与启动 (Device Pairing & Onboarding)

SilverLink 采用简便的配对流程，将家属端与长辈端设备绑定，建立安全的远程连接。

## 功能特性

### 1. 角色选择与引导
- **启动引导**：应用首次启动时进入 `RoleSelectionScreen`，用户选择身份（"我是家属" 或 "我是长辈"）。
- **差异化配置**：根据选择的角色，应用自动加载不同的 UI 模式和功能模块。

### 2. 双向配对流程
- **家属端生成 (Family Setup)**：
    - 家属填写基础信息（自己的称呼、长辈的称呼等）。
    - 录入长辈设备信息（可选）。
    - 生成唯一的**绑定二维码** (QR Code)。
- **长辈端扫描 (Elder Activation)**：
    - 长辈端选择身份后，直接进入扫码界面。
    - 扫描家属端生成的二维码即可完成绑定。
    - **无需复杂输入**：长辈无需输入账号密码，极大降低使用门槛。

### 3. 声纹采集 (Voice Enrollment)
- 在配对过程中，家属可录制一段语音（如"你好，我是小明"）。
- 该语音将用于训练 AI 声音模型 (Voice Cloning)，使长辈端的 AI 助手能够使用家属的声音进行对话。

### 4. 个性化设置
- **方言偏好**：在配对阶段即可选择长辈熟悉的方言（如四川话、广东话）。
- **称呼设置**：设置 AI 对长辈的亲切称呼（如"王奶奶"）。

## 技术实现

- **二维码机制**: 生成包含 JSON 格式配置信息的二维码，确保数据传输的准确性。
- **Cloud Function (`pairing-*`)**:
    - `pairing-create`: 创建配对会话，生成 token。
    - `pairing-verify`: 验证配对请求，建立设备间的关联关系 (FamilyDeviceID <-> ElderDeviceID)。
- **Onboarding Navigation**: 使用 Jetpack Compose Navigation 管理复杂的引导流程。

## 安全性
- 配对二维码具有时效性。
- 设备绑定后，只有绑定的家属账号才有权限查看长辈的位置和监控数据。
